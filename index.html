<script>
    const videos = [
        "Modulo 1.mp4", "Modulo 2.mp4", "Modulo 3.mp4", "Modulo 4.mp4", "Modulo 5.mp4",
        "Modulo 6.mp4", "Modulo 7.mp4", "Modulo 8.mp4", "Modulo 9.mp4", "Modulo 10.mp4"
    ];
    let currentIndex = 0; // Sempre começar no primeiro vídeo
    const lockKey = "videoAccessTime";

    function login() {
        const username = document.getElementById("username").value;
        if (username) {
            localStorage.setItem("username", username);
            document.getElementById("login-form").style.display = "none";
            document.getElementById("video-section").style.display = "flex";
            document.getElementById("user-name").innerText = username;
            loadVideo(); // Carregar o vídeo corretamente ao fazer login
        }
    }

    function loadVideo() {
        const lastAccess = localStorage.getItem(lockKey);
        const now = new Date().getTime();

        // Checar tempo para liberar próximo vídeo
        if (lastAccess && now - lastAccess < 86400000) { // 24 horas
            document.getElementById("next-video-btn").disabled = true;
            document.getElementById("message").innerText = "Você deve esperar 24 horas para assistir ao próximo vídeo.";
        } else {
            document.getElementById("next-video-btn").disabled = false;
            document.getElementById("message").innerText = "";
        }

        // Certificar que o primeiro vídeo seja carregado
        document.getElementById("video-source").src = videos[currentIndex];
        document.getElementById("video-player").load();
    }

    function nextVideo() {
        const now = new Date().getTime();
        localStorage.setItem(lockKey, now);

        if (currentIndex < videos.length - 1) {
            currentIndex++; // Avançar para o próximo vídeo
            loadVideo();
        } else {
            document.getElementById("message").innerText = "Você assistiu a todos os vídeos disponíveis.";
        }

        // Bloquear botão após avançar
        document.getElementById("next-video-btn").disabled = true;
    }

    // Auto-login se usuário já está salvo
    window.onload = function () {
        const savedUsername = localStorage.getItem("username");
        if (savedUsername) {
            document.getElementById("login-form").style.display = "none";
            document.getElementById("video-section").style.display = "flex";
            document.getElementById("user-name").innerText = savedUsername;

            // Reiniciar o índice para garantir que o primeiro vídeo seja carregado
            currentIndex = 0;
            loadVideo();
        }
    };
</script>
